<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>tween_main.gd</title>
<style type="text/css">
/* highlight theme: Godot Engine */
body.hl	{ background-color:#222026; }
pre.hl	{ color:#aaaaaa; background-color:#222026; font-size:12pt; font-family:'Consolas';}
.hl.num { color:#eb9531; }
.hl.esc { color:#ef6ebd; }
.hl.str { color:#ef6ebd; }
.hl.pps { color:#ef6ebd; }
.hl.slc { color:#973d1a; }
.hl.com { color:#973d1a; }
.hl.ppc { color:#7b5dbd; }
.hl.opt { color:#badfff; }
.hl.ipl { color:#ef6ebd; }
.hl.lin { color:#58575b; }
.hl.kwa { color:#ffffb3; }
.hl.kwb { color:#a3ffd4; }
.hl.kwc { color:#66a1cd; }
.hl.kwd { color:#e64d59; }
</style>
</head>
<body class="hl">
<pre class="hl"><span class="hl lin">  1 </span>
<span class="hl lin">  2 </span><span class="hl kwa">extends</span> Control
<span class="hl lin">  3 </span>
<span class="hl lin">  4 </span><span class="hl slc"># Member variables</span>
<span class="hl lin">  5 </span><span class="hl kwa">var</span> trans <span class="hl opt">= [</span><span class="hl str">&quot;linear&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;sine&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;quint&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;quart&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;quad&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;expo&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;elastic&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;cubic&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;circ&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;bounce&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;back&quot;</span><span class="hl opt">]</span>
<span class="hl lin">  6 </span><span class="hl kwa">var</span> eases <span class="hl opt">= [</span><span class="hl str">&quot;in&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;out&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;in_out&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;out_in&quot;</span><span class="hl opt">]</span>
<span class="hl lin">  7 </span><span class="hl kwa">var</span> modes <span class="hl opt">= [</span><span class="hl str">&quot;move&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;color&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;scale&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;rotate&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;callback&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;follow&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;repeat&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;pause&quot;</span><span class="hl opt">]</span>
<span class="hl lin">  8 </span>
<span class="hl lin">  9 </span><span class="hl kwa">var</span> state <span class="hl opt">= {</span>
<span class="hl lin"> 10 </span>    trans <span class="hl opt">=</span> Tween<span class="hl opt">.</span><span class="hl kwd">TRANS_LINEAR</span><span class="hl opt">,</span>
<span class="hl lin"> 11 </span>    eases <span class="hl opt">=</span> Tween<span class="hl opt">.</span><span class="hl kwd">EASE_IN</span><span class="hl opt">,</span>
<span class="hl lin"> 12 </span><span class="hl opt">}</span>
<span class="hl lin"> 13 </span>
<span class="hl lin"> 14 </span>
<span class="hl lin"> 15 </span><span class="hl kwa">func</span> <span class="hl kwc">_ready</span><span class="hl opt">():</span>
<span class="hl lin"> 16 </span>    <span class="hl kwa">for</span> index <span class="hl kwa">in range</span><span class="hl opt">(</span>trans<span class="hl opt">.</span><span class="hl kwc">size</span><span class="hl opt">()):</span>
<span class="hl lin"> 17 </span>        <span class="hl kwa">var</span> name <span class="hl opt">=</span> trans<span class="hl opt">[</span>index<span class="hl opt">]</span>
<span class="hl lin"> 18 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;trans/&quot;</span> <span class="hl opt">+</span> name<span class="hl opt">).</span><span class="hl kwc">connect</span><span class="hl opt">(</span><span class="hl str">&quot;pressed&quot;</span><span class="hl opt">,</span> <span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl str">&quot;on_trans_changed&quot;</span><span class="hl opt">, [</span>name<span class="hl opt">,</span> index<span class="hl opt">])</span>
<span class="hl lin"> 19 </span>    
<span class="hl lin"> 20 </span>    <span class="hl kwa">for</span> index <span class="hl kwa">in range</span><span class="hl opt">(</span>eases<span class="hl opt">.</span><span class="hl kwc">size</span><span class="hl opt">()):</span>
<span class="hl lin"> 21 </span>        <span class="hl kwa">var</span> name <span class="hl opt">=</span> eases<span class="hl opt">[</span>index<span class="hl opt">]</span>
<span class="hl lin"> 22 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;eases/&quot;</span> <span class="hl opt">+</span> name<span class="hl opt">).</span><span class="hl kwc">connect</span><span class="hl opt">(</span><span class="hl str">&quot;pressed&quot;</span><span class="hl opt">,</span> <span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl str">&quot;on_eases_changed&quot;</span><span class="hl opt">, [</span>name<span class="hl opt">,</span> index<span class="hl opt">])</span>
<span class="hl lin"> 23 </span>    
<span class="hl lin"> 24 </span>    <span class="hl kwa">for</span> index <span class="hl kwa">in range</span><span class="hl opt">(</span>modes<span class="hl opt">.</span><span class="hl kwc">size</span><span class="hl opt">()):</span>
<span class="hl lin"> 25 </span>        <span class="hl kwa">var</span> name <span class="hl opt">=</span> modes<span class="hl opt">[</span>index<span class="hl opt">]</span>
<span class="hl lin"> 26 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/&quot;</span> <span class="hl opt">+</span> name<span class="hl opt">).</span><span class="hl kwc">connect</span><span class="hl opt">(</span><span class="hl str">&quot;pressed&quot;</span><span class="hl opt">,</span> <span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl str">&quot;on_modes_changed&quot;</span><span class="hl opt">, [</span>name<span class="hl opt">])</span>
<span class="hl lin"> 27 </span>    
<span class="hl lin"> 28 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_from&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_color</span><span class="hl opt">(</span><span class="hl kwb">Color</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">1</span><span class="hl opt">))</span>
<span class="hl lin"> 29 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_from&quot;</span><span class="hl opt">).</span><span class="hl kwc">connect</span><span class="hl opt">(</span><span class="hl str">&quot;color_changed&quot;</span><span class="hl opt">,</span> <span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl str">&quot;on_color_changed&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 30 </span>    
<span class="hl lin"> 31 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_to&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_color</span><span class="hl opt">(</span><span class="hl kwb">Color</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">1</span><span class="hl opt">,</span> <span class="hl num">1</span><span class="hl opt">,</span> <span class="hl num">1</span><span class="hl opt">))</span>
<span class="hl lin"> 32 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_to&quot;</span><span class="hl opt">).</span><span class="hl kwc">connect</span><span class="hl opt">(</span><span class="hl str">&quot;color_changed&quot;</span><span class="hl opt">,</span> <span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl str">&quot;on_color_changed&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 33 </span>    
<span class="hl lin"> 34 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;trans/linear&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin"> 35 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;eases/in&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin"> 36 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/move&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin"> 37 </span>    <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/repeat&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin"> 38 </span>    
<span class="hl lin"> 39 </span>    <span class="hl kwc">reset_tween</span><span class="hl opt">()</span>
<span class="hl lin"> 40 </span>
<span class="hl lin"> 41 </span>
<span class="hl lin"> 42 </span><span class="hl kwa">func</span> <span class="hl kwc">on_trans_changed</span><span class="hl opt">(</span>name<span class="hl opt">,</span> index<span class="hl opt">):</span>
<span class="hl lin"> 43 </span>    <span class="hl kwa">for</span> index <span class="hl kwa">in range</span><span class="hl opt">(</span>trans<span class="hl opt">.</span><span class="hl kwc">size</span><span class="hl opt">()):</span>
<span class="hl lin"> 44 </span>        <span class="hl kwa">var</span> pressed <span class="hl opt">=</span> trans<span class="hl opt">[</span>index<span class="hl opt">] ==</span> name
<span class="hl lin"> 45 </span>        <span class="hl kwa">var</span> btn <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;trans/&quot;</span> <span class="hl opt">+</span> trans<span class="hl opt">[</span>index<span class="hl opt">])</span>
<span class="hl lin"> 46 </span>        
<span class="hl lin"> 47 </span>        btn<span class="hl opt">.</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span>pressed<span class="hl opt">)</span>
<span class="hl lin"> 48 </span>        btn<span class="hl opt">.</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span>pressed<span class="hl opt">)</span>
<span class="hl lin"> 49 </span>    
<span class="hl lin"> 50 </span>    state<span class="hl opt">.</span><span class="hl kwd">trans</span> <span class="hl opt">=</span> index
<span class="hl lin"> 51 </span>    <span class="hl kwc">reset_tween</span><span class="hl opt">()</span>
<span class="hl lin"> 52 </span>
<span class="hl lin"> 53 </span>
<span class="hl lin"> 54 </span><span class="hl kwa">func</span> <span class="hl kwc">on_eases_changed</span><span class="hl opt">(</span>name<span class="hl opt">,</span> index<span class="hl opt">):</span>
<span class="hl lin"> 55 </span>    <span class="hl kwa">for</span> index <span class="hl kwa">in range</span><span class="hl opt">(</span>eases<span class="hl opt">.</span><span class="hl kwc">size</span><span class="hl opt">()):</span>
<span class="hl lin"> 56 </span>        <span class="hl kwa">var</span> pressed <span class="hl opt">=</span> eases<span class="hl opt">[</span>index<span class="hl opt">] ==</span> name
<span class="hl lin"> 57 </span>        <span class="hl kwa">var</span> btn <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;eases/&quot;</span> <span class="hl opt">+</span> eases<span class="hl opt">[</span>index<span class="hl opt">])</span>
<span class="hl lin"> 58 </span>        
<span class="hl lin"> 59 </span>        btn<span class="hl opt">.</span><span class="hl kwc">set_pressed</span><span class="hl opt">(</span>pressed<span class="hl opt">)</span>
<span class="hl lin"> 60 </span>        btn<span class="hl opt">.</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span>pressed<span class="hl opt">)</span>
<span class="hl lin"> 61 </span>    
<span class="hl lin"> 62 </span>    state<span class="hl opt">.</span><span class="hl kwd">eases</span> <span class="hl opt">=</span> index
<span class="hl lin"> 63 </span>    <span class="hl kwc">reset_tween</span><span class="hl opt">()</span>
<span class="hl lin"> 64 </span>
<span class="hl lin"> 65 </span>
<span class="hl lin"> 66 </span><span class="hl kwa">func</span> <span class="hl kwc">on_modes_changed</span><span class="hl opt">(</span>name<span class="hl opt">):</span>
<span class="hl lin"> 67 </span>    <span class="hl kwa">var</span> tween <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 68 </span>    <span class="hl kwa">if</span> name <span class="hl opt">==</span> <span class="hl str">&quot;pause&quot;</span><span class="hl opt">:</span>
<span class="hl lin"> 69 </span>        <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/pause&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin"> 70 </span>            tween<span class="hl opt">.</span><span class="hl kwc">stop_all</span><span class="hl opt">()</span>
<span class="hl lin"> 71 </span>            <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span><span class="hl kwa">false</span><span class="hl opt">)</span>
<span class="hl lin"> 72 </span>        <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin"> 73 </span>            tween<span class="hl opt">.</span><span class="hl kwc">resume_all</span><span class="hl opt">()</span>
<span class="hl lin"> 74 </span>            <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin"> 75 </span>    <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin"> 76 </span>        <span class="hl kwc">reset_tween</span><span class="hl opt">()</span>
<span class="hl lin"> 77 </span>
<span class="hl lin"> 78 </span>
<span class="hl lin"> 79 </span><span class="hl kwa">func</span> <span class="hl kwc">on_color_changed</span><span class="hl opt">(</span>color<span class="hl opt">):</span>
<span class="hl lin"> 80 </span>    <span class="hl kwc">reset_tween</span><span class="hl opt">()</span>
<span class="hl lin"> 81 </span>
<span class="hl lin"> 82 </span>
<span class="hl lin"> 83 </span><span class="hl kwa">func</span> <span class="hl kwc">reset_tween</span><span class="hl opt">():</span>
<span class="hl lin"> 84 </span>    <span class="hl kwa">var</span> tween <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 85 </span>    <span class="hl kwa">var</span> pos <span class="hl opt">=</span> tween<span class="hl opt">.</span><span class="hl kwc">tell</span><span class="hl opt">()</span>
<span class="hl lin"> 86 </span>    tween<span class="hl opt">.</span><span class="hl kwc">reset_all</span><span class="hl opt">()</span>
<span class="hl lin"> 87 </span>    tween<span class="hl opt">.</span><span class="hl kwc">remove_all</span><span class="hl opt">()</span>
<span class="hl lin"> 88 </span>    
<span class="hl lin"> 89 </span>    <span class="hl kwa">var</span> sprite <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween/area/sprite&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 90 </span>    <span class="hl kwa">var</span> follow <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween/area/follow&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 91 </span>    <span class="hl kwa">var</span> follow_2 <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween/area/follow_2&quot;</span><span class="hl opt">)</span>
<span class="hl lin"> 92 </span>    <span class="hl kwa">var</span> size <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween/area&quot;</span><span class="hl opt">).</span><span class="hl kwc">get_size</span><span class="hl opt">()</span>
<span class="hl lin"> 93 </span>
<span class="hl lin"> 94 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/move&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin"> 95 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_method</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;set_pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">),</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span>size<span class="hl opt">.</span><span class="hl kwd">width</span><span class="hl opt">,</span> size<span class="hl opt">.</span><span class="hl kwd">height</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin"> 96 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_property</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;transform/pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span>size<span class="hl opt">.</span><span class="hl kwd">width</span><span class="hl opt">,</span> size<span class="hl opt">.</span><span class="hl kwd">height</span><span class="hl opt">),</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin"> 97 </span>    
<span class="hl lin"> 98 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/color&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin"> 99 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_method</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;set_modulate&quot;</span><span class="hl opt">,</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_from&quot;</span><span class="hl opt">).</span><span class="hl kwc">get_color</span><span class="hl opt">(),</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_to&quot;</span><span class="hl opt">).</span><span class="hl kwc">get_color</span><span class="hl opt">(),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin">100 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_property</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;modulate&quot;</span><span class="hl opt">,</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_to&quot;</span><span class="hl opt">).</span><span class="hl kwc">get_color</span><span class="hl opt">(),</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;color/color_from&quot;</span><span class="hl opt">).</span><span class="hl kwc">get_color</span><span class="hl opt">(),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin">101 </span>    <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin">102 </span>        sprite<span class="hl opt">.</span><span class="hl kwc">set_modulate</span><span class="hl opt">(</span><span class="hl kwb">Color</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">,</span><span class="hl num">1</span><span class="hl opt">,</span><span class="hl num">1</span><span class="hl opt">,</span><span class="hl num">1</span><span class="hl opt">))</span>
<span class="hl lin">103 </span>    
<span class="hl lin">104 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/scale&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">105 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_method</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;set_scale&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0.5</span><span class="hl opt">,</span> <span class="hl num">0.5</span><span class="hl opt">),</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">1.5</span><span class="hl opt">,</span> <span class="hl num">1.5</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin">106 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_property</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;transform/scale&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">1.5</span><span class="hl opt">,</span> <span class="hl num">1.5</span><span class="hl opt">),</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0.5</span><span class="hl opt">,</span> <span class="hl num">0.5</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin">107 </span>    <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin">108 </span>        sprite<span class="hl opt">.</span><span class="hl kwc">set_scale</span><span class="hl opt">(</span><span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">,</span><span class="hl num">1</span><span class="hl opt">))</span>
<span class="hl lin">109 </span>    
<span class="hl lin">110 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/rotate&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">111 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_method</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;set_rotd&quot;</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">360</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin">112 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_property</span><span class="hl opt">(</span>sprite<span class="hl opt">,</span> <span class="hl str">&quot;transform/rot&quot;</span><span class="hl opt">,</span> <span class="hl num">360</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin">113 </span>    
<span class="hl lin">114 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/callback&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">115 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_callback</span><span class="hl opt">(</span><span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl num">0.5</span><span class="hl opt">,</span> <span class="hl str">&quot;on_callback&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;0.5 second&apos;s after&quot;</span><span class="hl opt">)</span>
<span class="hl lin">116 </span>        tween<span class="hl opt">.</span><span class="hl kwc">interpolate_callback</span><span class="hl opt">(</span><span class="hl kwa">self</span><span class="hl opt">,</span> <span class="hl num">0.2</span><span class="hl opt">,</span> <span class="hl str">&quot;on_callback&quot;</span><span class="hl opt">,</span> <span class="hl str">&quot;1.2 second&apos;s after&quot;</span><span class="hl opt">)</span>
<span class="hl lin">117 </span>    
<span class="hl lin">118 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/follow&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">119 </span>        follow<span class="hl opt">.</span><span class="hl kwc">show</span><span class="hl opt">()</span>
<span class="hl lin">120 </span>        follow_2<span class="hl opt">.</span><span class="hl kwc">show</span><span class="hl opt">()</span>
<span class="hl lin">121 </span>        
<span class="hl lin">122 </span>        tween<span class="hl opt">.</span><span class="hl kwc">follow_method</span><span class="hl opt">(</span>follow<span class="hl opt">,</span> <span class="hl str">&quot;set_pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> size<span class="hl opt">.</span><span class="hl kwd">height</span><span class="hl opt">),</span> sprite<span class="hl opt">,</span> <span class="hl str">&quot;get_pos&quot;</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin">123 </span>        tween<span class="hl opt">.</span><span class="hl kwc">targeting_method</span><span class="hl opt">(</span>follow<span class="hl opt">,</span> <span class="hl str">&quot;set_pos&quot;</span><span class="hl opt">,</span> sprite<span class="hl opt">,</span> <span class="hl str">&quot;get_pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> size<span class="hl opt">.</span><span class="hl kwd">height</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin">124 </span>        
<span class="hl lin">125 </span>        tween<span class="hl opt">.</span><span class="hl kwc">targeting_property</span><span class="hl opt">(</span>follow_2<span class="hl opt">,</span> <span class="hl str">&quot;transform/pos&quot;</span><span class="hl opt">,</span> sprite<span class="hl opt">,</span> <span class="hl str">&quot;transform/pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span>size<span class="hl opt">.</span><span class="hl kwd">width</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">),</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">)</span>
<span class="hl lin">126 </span>        tween<span class="hl opt">.</span><span class="hl kwc">follow_property</span><span class="hl opt">(</span>follow_2<span class="hl opt">,</span> <span class="hl str">&quot;transform/pos&quot;</span><span class="hl opt">,</span> <span class="hl kwb">Vector2</span><span class="hl opt">(</span>size<span class="hl opt">.</span><span class="hl kwd">width</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">),</span> sprite<span class="hl opt">,</span> <span class="hl str">&quot;transform/pos&quot;</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">trans</span><span class="hl opt">,</span> state<span class="hl opt">.</span><span class="hl kwd">eases</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl lin">127 </span>    <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin">128 </span>        follow<span class="hl opt">.</span><span class="hl kwc">hide</span><span class="hl opt">()</span>
<span class="hl lin">129 </span>        follow_2<span class="hl opt">.</span><span class="hl kwc">hide</span><span class="hl opt">()</span>
<span class="hl lin">130 </span>    
<span class="hl lin">131 </span>    tween<span class="hl opt">.</span><span class="hl kwc">set_repeat</span><span class="hl opt">(</span><span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/repeat&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">())</span>
<span class="hl lin">132 </span>    tween<span class="hl opt">.</span><span class="hl kwc">start</span><span class="hl opt">()</span>
<span class="hl lin">133 </span>    tween<span class="hl opt">.</span><span class="hl kwc">seek</span><span class="hl opt">(</span>pos<span class="hl opt">)</span>
<span class="hl lin">134 </span>    
<span class="hl lin">135 </span>    <span class="hl kwa">if</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/pause&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">136 </span>        tween<span class="hl opt">.</span><span class="hl kwc">stop_all</span><span class="hl opt">()</span>
<span class="hl lin">137 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span><span class="hl kwa">false</span><span class="hl opt">)</span>
<span class="hl lin">138 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_value</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">)</span>
<span class="hl lin">139 </span>    <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin">140 </span>        tween<span class="hl opt">.</span><span class="hl kwc">resume_all</span><span class="hl opt">()</span>
<span class="hl lin">141 </span>        <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">).</span><span class="hl kwc">set_ignore_mouse</span><span class="hl opt">(</span><span class="hl kwa">true</span><span class="hl opt">)</span>
<span class="hl lin">142 </span>
<span class="hl lin">143 </span>
<span class="hl lin">144 </span><span class="hl kwa">func</span> <span class="hl kwc">_on_tween_step</span><span class="hl opt">(</span>object<span class="hl opt">,</span> key<span class="hl opt">,</span> elapsed<span class="hl opt">,</span> value<span class="hl opt">):</span>
<span class="hl lin">145 </span>    <span class="hl kwa">var</span> timeline <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;timeline&quot;</span><span class="hl opt">)</span>
<span class="hl lin">146 </span>    
<span class="hl lin">147 </span>    <span class="hl kwa">var</span> tween <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween&quot;</span><span class="hl opt">)</span>
<span class="hl lin">148 </span>    <span class="hl kwa">var</span> runtime <span class="hl opt">=</span> tween<span class="hl opt">.</span><span class="hl kwc">get_runtime</span><span class="hl opt">()</span>
<span class="hl lin">149 </span>    
<span class="hl lin">150 </span>    <span class="hl kwa">var</span> ratio <span class="hl opt">=</span> <span class="hl num">100</span><span class="hl opt">*(</span>elapsed<span class="hl opt">/</span>runtime<span class="hl opt">)</span>
<span class="hl lin">151 </span>    timeline<span class="hl opt">.</span><span class="hl kwc">set_value</span><span class="hl opt">(</span>ratio<span class="hl opt">)</span>
<span class="hl lin">152 </span>
<span class="hl lin">153 </span>
<span class="hl lin">154 </span><span class="hl kwa">func</span> <span class="hl kwc">_on_timeline_value_changed</span><span class="hl opt">(</span>value<span class="hl opt">):</span>
<span class="hl lin">155 </span>    <span class="hl kwa">if</span> <span class="hl opt">!</span><span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;modes/pause&quot;</span><span class="hl opt">).</span><span class="hl kwc">is_pressed</span><span class="hl opt">():</span>
<span class="hl lin">156 </span>        <span class="hl kwa">return</span>
<span class="hl lin">157 </span>    
<span class="hl lin">158 </span>    <span class="hl kwa">var</span> tween <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween&quot;</span><span class="hl opt">)</span>
<span class="hl lin">159 </span>    <span class="hl kwa">var</span> runtime <span class="hl opt">=</span> tween<span class="hl opt">.</span><span class="hl kwc">get_runtime</span><span class="hl opt">()</span>
<span class="hl lin">160 </span>    tween<span class="hl opt">.</span><span class="hl kwc">seek</span><span class="hl opt">(</span>runtime<span class="hl opt">*</span>value<span class="hl opt">/</span><span class="hl num">100</span><span class="hl opt">)</span>
<span class="hl lin">161 </span>
<span class="hl lin">162 </span>
<span class="hl lin">163 </span><span class="hl kwa">func</span> <span class="hl kwc">on_callback</span><span class="hl opt">(</span>arg<span class="hl opt">):</span>
<span class="hl lin">164 </span>    <span class="hl kwa">var</span> label <span class="hl opt">=</span> <span class="hl kwc">get_node</span><span class="hl opt">(</span><span class="hl str">&quot;tween/area/label&quot;</span><span class="hl opt">)</span>
<span class="hl lin">165 </span>    label<span class="hl opt">.</span><span class="hl kwc">add_text</span><span class="hl opt">(</span><span class="hl str">&quot;on_callback -&gt; &quot;</span> <span class="hl opt">+</span> arg <span class="hl opt">+</span> <span class="hl str">&quot;</span><span class="hl esc">\n</span><span class="hl str">&quot;</span><span class="hl opt">)</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.34, http://www.andre-simon.de/-->
